<div class="w-full lg:mx-auto lg:w-1/3 lg:mt-10">
  <h2>History</h2>
  <mat-card class="mb-3">
    <div class="w-auto">
      <div class="text-gray-400">Your Balance</div>
      <div class="flex w-full flex-wrap text-center">
        <div class="w-2/5 whitespace-nowrap m-auto">
          UPX: <span class="text-2xl">{{ uupxAmount | microNumber }}</span>
        </div>
        <div class="w-2/5 whitespace-nowrap m-auto">
          SPX:<span class="text-2xl">{{ uspxAmount | microNumber }}</span>
        </div>
      </div>
    </div>
  </mat-card>

  <mat-card class="mb-3">
    <mat-form-field appearance="fill" class="w-1/3 mr-2">
      <mat-label style="font-size: 5px">Select Token</mat-label>
      <mat-select [(value)]="selectedToken" class="w-5 text-xs">
        <mat-option value="default">All Tokens</mat-option>
        <mat-option value="UPX">UPX</mat-option>
        <mat-option value="SPX">SPX</mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field appearance="fill" class="w-auto">
      <mat-label style="font-size: 5px">All Transactions</mat-label>
      <mat-select [(value)]="selectedTransaction" class="w-5 text-xs">
        <mat-option value="default">All Transactions</mat-option>
        <mat-option value="Auction">Auction</mat-option>
        <mat-option value="Daily Withdraw">Daily Withdraw</mat-option>
        <mat-option value="Admin">Admin</mat-option>
      </mat-select>
    </mat-form-field>

    <!-- <mat-form-field appearance="fill">
      <mat-label>Enter a date range</mat-label>
      <mat-date-range-input [rangePicker]="picker">
        <input matStartDate placeholder="Start date" />
        <input matEndDate placeholder="End date" />
      </mat-date-range-input>
      <mat-hint>MM/DD/YYYY â€“ MM/DD/YYYY</mat-hint>
      <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
      <mat-date-range-picker #picker></mat-date-range-picker>
    </mat-form-field> -->

    <mat-nav-list>
      <ng-template #loading>
        <mat-progress-spinner [diameter]="60" [mode]="'indeterminate'"></mat-progress-spinner>
      </ng-template>
      <ng-container *ngIf="histories === null; then loading; else loadedHistory"></ng-container>
      <ng-template #loadedHistory>
        <ng-container *ngIf="!histories?.length">
          <mat-list-item>No history</mat-list-item>
        </ng-container>
        <ng-container *ngFor="let history of histories">
          <mat-list-item routerLink="/txs/history/{{ powerType(history.isSolar) }}/{{ txType(history.isBid) }}/{{ history.id }}">
            <span class="text-sm flex-auto mr-3">{{ history.date | date: 'MM/dd HH:MM' }}</span>

            <ng-container *ngIf="history.isSolar === true; then solar; else utility"></ng-container>

            <ng-template #solar>
              <div class="text-sm flex-auto mr-3">SPX</div>
              <div class="flex-auto">
                <ng-container *ngIf="history.isBid === true; then solarBid; else solarAsk"></ng-container>
                <ng-template #solarBid>
                  <span style="color: #3f51b5">+{{ history.utokenAmount | microString }}</span>
                </ng-template>
                <ng-template #solarAsk>
                  <span style="color: #ff4081">-{{ history.utokenAmount | microString }}</span>
                </ng-template>
              </div>
            </ng-template>

            <ng-template #utility>
              <div class="text-sm flex-auto mr-3">UPX</div>
              <div class="flex-auto">
                <ng-container *ngIf="history.isBid === true; then utilityBid; else utilityAsk"></ng-container>
                <ng-template #utilityBid>
                  <span class="text-lg" style="color: #3f51b5">+{{ history.utokenAmount | microString }}</span>
                </ng-template>
                <ng-template #utilityAsk>
                  <span style="color: #ff4081">-{{ history.utokenAmount | microString }}</span>
                </ng-template>
              </div>
            </ng-template>
          </mat-list-item>
          <mat-divider [inset]="true"></mat-divider>
        </ng-container>
      </ng-template>
    </mat-nav-list>
  </mat-card>
</div>
