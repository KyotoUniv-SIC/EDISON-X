# EDISON アップデート 2022/06/30

2022/06/30 [株式会社 CauchyE](https://cauchye.com/) 大村瀬奈 作成

## 概要

2022 年 7 月 1 日より京都大学大学院総合生存学館の合宿型研修施設にてシステム実証実験を開始して、2022 年度末まで実施する。

それに先立って、以下のアップデートを実施する。

## アップデート

### Token 管理の再設計

現在、Token は小数点以下を所要した値となっており、1UPX (SPX) = 1kWh となっている。この設計で現在、小数点以下の丸め誤差が発生しているため、トークン数を 10^6 倍し、小数点以下切り捨てで実装することで精度と計算速度を改善する。

### 太陽光パネルの発電電力量データの読み込み

東一条館の太陽光パネルの発電量をメールで取得し、それを GAS (Google Apps Script)で処理することで Firebase のデータベース (Firestore)に反映し、同量の SPX トークンを発行する。

### 注文履歴の保存

売り注文 (Bid)と買い注文 (Ask)の以下の情報を History データとしてデータベースに記録する。csv 形式でフロントエンドから取得可能にし、グラフ等を作成できるようにする。

- ID
- type
- bidder or askerID
- price
- amount
- isAccepted
- contractPrice
- createdAtTimestamp
- timeStamp

### 価格調整

トークン価格インフレを抑えるために以下 2 つの機能を実装する。

- UPX 価格と約定電力量の日時時系列を表示する。グラフに目安として 27JPY/kWh を表示する。
- 価格高騰時のシステムからの市場介入を実装する。フロントエンドに介入状況を表示する。介入のオン・オフをフロントから切り替え可能にする。

### SPX 購入のインセンティブ付与

フロントエンドに現在の CO2 排出量 (UPX 使用量)のランキングを通知し、下位 3 名に少額の賞金を与えて表彰する。この賞金と表彰をインセンティブとする。

### 初期トークン付与

アカウント作成時に部屋番号を要求し、その部屋番号の先月の電気使用量を基準にトークン付与量を決定する。
