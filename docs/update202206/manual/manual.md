# EDISON 概要

2022/06/30 [株式会社 CauchyE](https://cauchye.com/) 大村瀬奈 作成

## システム概要

EDISON はブロックチェーン（XRP Ledger）を用いて、電気使用権となるトークンを売買するシステムです。電気使用権はその特性から 2 種類のトークンとなっており、電力会社から購入した電気を使用できる`UPX`トークンと東一条館のソーラーで発電された電気を使用できる`SPX`トークンが存在します。

毎日の電気使用量は翌日以降にアカウントのトークン残高から SPX を優先して差し引かれます。ユーザーはこのトークン取引を通じて、自身の使用する電気の種類や価格の決定に関与できます。
毎月 1 日に前月分の精算が行われ、請求額が自動的に計算されます。

### 導入

EDISON の使用にはアカウント作成が必要です。アカウント作成ページは後の`EDISON 主要画面`を参照してください。
アカウント作成後、XRP Ledger の Wallet 作成とアカウントへの紐付けが自動で行われます。アカウント詳細ページには自動で XRP アドレスと残高が反映されます。

残高はアカウント作成時に入力した部屋番号の先月の電気使用実績と同量の UPX トークンとなります。この残高は 1UPX あたり 27 円で購入したものとして扱われます。

EDISON ではメールアドレス認証を行っているので、登録したメールアドレス宛に届くメールを確認してください。メールアドレス確認前はほとんどの機能を使用できません。

### ユーザーの動作

EDISON の主な機能は UPX・SPX トークンの取引です。ユーザーは 11:00-翌日 8:59 の間、トークン市場で毎日 9 時に開催されるオークションへの入札を行うことができます。売り注文を行うか、買い注文を行うかを決め、価格と数量を入力します。空売りはできないため、売り注文は自身の残高の範囲でしかできません。
オークションはシングルプライスオークション形式を採用しています。詳細については別紙を参照してください。

ユーザーによる売り注文、買い注文のほか、システムも注文を行います。
UPX については価格が乖離した際に市場介入を行います。売り注文、買い注文のほか、介入が発生しないケースもあります。
SPX については東一条館のソーラーで発電された電気の一定割合を毎日売り注文として行います。SPX についてはアカウント作成時や精算の際に付与されないため、主にこの売り注文に対して応札することで入手が可能です。

また、電気使用量は毎日、前日の使用量がアカウントの残高から差し引かれます。次回の引き落としの量についてはダッシュボード画面から確認可能です。また、ダッシュボードには取引の参考となる情報が各種表示されます。

### 月末の精算

毎月 1 日はオークションの後に精算が行われます。精算では最終的な残高やこれまでの注文履歴、使用量の引き落としの記録が考慮された上で、余剰トークンの買い取りと不足トークンの販売が自動的に行われ、前月の電気使用の請求額が確定します。

当月には前月の余剰トークンは引き継がず、新しく前月の電気使用量と同量の UPX トークンが付与されます。このトークンは新規にアカウントを作成した際に付与される UPX トークンと同様に 1UPX あたり 27 円で購入したものとして扱われます。

### 管理者による設定の変更

`/admin`に接続することでより詳細な EDISON の状況の確認や各種設定の変更が可能です。
管理者は以下の設定について変更することができます。

- 次に市場介入される UPX トークンの価格と計算された介入量の何%を実際に行うか
- 次に行われる SPX 売り注文の価格と量
- SPX 利用割合上位のユーザーに対する報酬額
- EDISON システム運用にかかるコストと全体の電気料金の設定

## EDISON 主要画面

リリース時点での EDISON の主要な画面の説明です。画像は Google Chrome Laptop L (1440px)の画面であり、モバイルなどの環境では表示が異なります。

### トップページ

EDISON プロジェクトのランディングページです。ソーシャルイノベーションセンター、CauchyE の WEB サイト、GitHub ページのリンクに加え、EDISON の簡単な説明を記載しています。

<img src='lp.png'>

<div style="page-break-before:always"></div>

### 登録画面

アカウント作成画面です。名前（4 文字以上）、メールアドレス、パスワード（8 文字以上）、部屋番号を入力してアカウントを作成するためのページです。ログインしていない場合は上のヘッダーから、また、トップページのリンクからもアクセス可能です。

<img src='accounts-create.png'>

### ログイン画面

すでにアカウントを作成している場合、ログインするためのページです。ログインしていない場合は上のヘッダーからアクセス可能です。メールアドレスとパスワードを入力してログインします。

<img src='accounts-enter.png'>

<div style="page-break-before:always"></div>

### アカウントの機能

#### アカウント管理画面

アカウントの情報、残高に加え、今までの電気料金の月額を確認できるページです。
XRP Address をクリックすると次項の XRP Ledger のページに遷移します。
また、アカウント作成時に送信されるメール認証ができておらず、`Unverified`と表示されている場合は EDISON の殆どの機能を使用できません。メールを確認するか、メールが見当たらない場合は`Unverified`をクリックすることでメールを再送信できます。

<img src='accounts-account.png'>

#### 月額詳細画面

月ごとの請求の詳細を確認できるページです。各項目の詳細は以下の通りとなります。

- Primary Transaction
  月初に付与されるトークンへの支払い額
- Surplus or Shortage Tokens
  月末に余っていた or 不足していたトークンの精算額
- Payments to the Market
  当月のマーケットでの売り買いの収支額
- CO2 Ranking Reward
  SPX の消費割合上位に付与される報酬額（現在の設定は 1 位 600 円、2 位 300 円、3 位 100 円となっています。）

<img src='accounts-payment.png'>

#### XRP Ledger

現在ログインしているアカウントの XRP Ledger ブロックチェーン上に記録されている情報をリアルタイムで取得するページです。

KUINS のセキュリティルールの問題で KUINS-Air 経由では情報の取得ができません。

- Account on EDISON
  EDISON に記録されている XRP Address やデーターベース上の UPX・SPX の残高に関する情報を表示しています。他の画面での残高は`Insufficient Balance`を考慮しており、一致しないことがあります。
- EDISON Token Balance
  XRP Ledger 上で記録されている UPX・SPX の残高を表示しています。通常、EDISON の残高と一致します。
- XRP Balance
  アカウントが持つ XRP の残高です。テストネットではアカウント作成時に 1000XRP を付与しております。
  成約した取引を実行する際に手数料としてごく少量の XRP が使用されます。

<img src='accounts-xrpl.png'>

<div style="page-break-before:always"></div>

### ダッシュボード

EDISON における重要な情報を一括で閲覧できるダッシュボードのページです。
以下の項目についてこのページで確認することができます。

- 最上段
  - 現在のアカウントの残高（円グラフはトークン比率）
  - 直近の取引価格
  - これまでの取引価格と取引量の推移
- 上段
  - 電気料金の参考（関西電力の電気料金）
  - 現在の市場介入状況
- 下段
  - 次の電気使用量取引の明細（次の日の 9 時半ごろに残高から引かれる）
  - 電気使用量と CO2 排出量のランキング
- 最下段
  - 当月の電気使用量と学生全体の平均値
  - 前月の電気使用量と CO2 排出量の実績値と学生全体の平均値

<img src='dashboard.png'>

### トランザクション画面

#### トランザクション一覧

トークンの売り注文・買い注文を行うページへのリンクに加え、以下の情報を確認することが可能なページです。

- 本日の注文

  - 売り注文
  - 買い注文

- 今までの注文の履歴
  - 売り注文（成約したのかどうか）
  - 買い注文（成約したのかどうか）
  - 月初のトークン付与

各注文や注文の履歴をクリックすることで詳細な情報を表示するページに遷移します。注文は取り消すことも可能です。

<div style="page-break-before:always"></div>

<img src='txs.png'>

#### 買い注文画面

買い注文を行うことができるページです。自分が今回の取引で利用可能な残高（UPX, SPX, ある場合は残高不足）と最新の取引価格が表示され、トークンの種類と価格、数量を決めて売り注文を発行できます。午前 9 時から 11 時の間はダウンタイムとなっており、注文ができません。

<img src='txs-buy.png'>

<div style="page-break-before:always"></div>

#### 売り注文画面

売り注文を行うことができるページです。表示されている内容は買い注文のページと同様で、同じく午前 9 時から 11 時の間はダウンタイムとなっており、注文ができません。

<img src='txs-buy.png'>

### 通知画面

学生からのフィードバックを受け、非表示にしております。

### 管理者画面

以下の管理者画面へのアクセスにはパスワードが必要です。
パスワードはエネルギーサーバーのメールアドレスのパスワードと同じものです。

<img src='admin-auth.png'>

<img src='admin.png'>

#### ダッシュボード（管理者）

EDISON の 管理における重要な情報を一括で閲覧できる管理者用のダッシュボードのページです。情報については Download CSV ボタンにより CSV 形式でのダウンロードも可能です。
以下の項目についてこのページで確認することができます。

- EDISON のすべてのアカウントの合計残高
  - Download CSV で個別の残高情報を取得可能
- 直近の取引価格
- 現在の入札状況
  - Download CSV ですべての入札の詳細な情報を取得可能
- 過去の注文
  - 日付を指定し、成約済のみかどうかを指定して取得可能
- 電気使用量のランキング
  - Download CSV で詳細な情報を取得可能
- 月間の合計電気使用量の推移（前年・本年）
  - Download CSV で詳細な情報を取得可能

<img src='admin-dashboard.png'>

<div style="page-break-before:always"></div>

#### XRP Ledger（管理者）

管理者アカウントの XRP Ledger ブロックチェーン上に記録されている情報をリアルタイムで取得するページです。
以下の内容について表示されています。
KUINS のセキュリティルールの問題で KUINS-Air 経由では情報の取得ができません。

- EDISON Token Hot Wallet Balance
  システムがあと、どのくらいのトークンを発行できるか
- EDISON Token Cold Wallet Balance
  誰がどのくらいの量の UPX・SPX を保有しているか
- XRP Hot Wallet Balance
  学生との間でシステムが取引をする際に手数料として使用される XRP の残高
- XRP Cold Wallet Balance
  トークンを追加発行する場合に手数料として使用される XRP の残高

<img src='admin-xrpl.png'>

#### トークン設定

管理者がトークンの発行の設定を行うページです。

- Next Issue UPX Price
  次の UPX 市場介入の情報を表示しています
  - 次に介入する際の UPX の価格
  - 計算された介入の量の何％を実際に介入するか
  - 市場介入が有効かどうか
- Change UPX Setting
  上記の設定を変更することが可能です
- Next Issue SPX Price
  SPX 発行の情報を表示しています
  - 次に発行する際の SPX の価格
  - SPX の発行量
- Change SPX Setting
  上記の設定を変更することが可能です
- System Cost Settings
  EDISON の運用に必要なコスト情報を表示しています
- Change Cost Settings
  上記の設定を変更することが可能です

<img src='admin-xrpl.png'>
